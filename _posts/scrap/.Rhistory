url <- paste0('https://stackoverflow.com/questions/tagged/',i)
webpage <- read_html(url)
# buscamos cuantas veces el tag secundario se asocia con el tag popular
count_html <- html_nodes(webpage,'.item-multiplier-count')
count <- html_text(count_html)
# buscamos el nombre de los lenguajes que mas se taggean con los lenguajes populares
rank_data_html <- html_nodes(webpage,'.js-gps-related-tags')
character<- as.character(rank_data_html)
strsplit <- strsplit(character," ")%>% unlist()
#despues de separar buscamos en que filas se encuentran los tag que nos importan
grep <- grep(paste0("/questions/tagged/",i),strsplit, value = T)
grep <- gsub(paste0("href=\"/questions/tagged/",i,"+"),"",grep)
grep <- gsub("\"","",grep)
second_tag <- substr(grep,2,nchar(grep))
popular <- rep(i,length(substr))
cbind <-  cbind(popular,second_tag) %>% cbind(count)
if(flag_first)  {
related_tags <- cbind
flag_first <- F
}else {related_tags <- rbind(related_tags,cbind)}
}
related_tags <- related_tags %>% data.frame(stringsAsFactors = F)
related_tags$count <-  related_tags$count %>% as.numeric()
related_tags
}
tabla_result <- related_tags(extract$rank_lenguaje_name)
muestra <- tabla_result %>% arrange(desc(count)) %>% head(150)
sources <- muestra %>%
distinct(popular) %>%
rename(label = popular)
destinations <- muestra %>%
distinct(second_tag) %>%
rename(label = second_tag)
nodes <- full_join(sources, destinations, by = "label")
nodes
nodes <- nodes %>% rowid_to_column("id")
nodes
per_route <- muestra %>%
group_by(popular, second_tag) %>%
summarise(weight = sum(count)) %>%
ungroup()
per_route
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
edges <- select(edges, from, to, weight)
edges
routes_tidy <- tbl_graph(nodes = nodes, edges = edges, directed = TRUE)
routes_tidy
routes_tidy %>%
activate(edges) %>%
arrange(desc(weight))
ggraph(routes_tidy, layout = "graphopt") +
geom_node_point() +
geom_edge_link(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label), repel = TRUE) +
labs(edge_width = "Letters") +
theme_graph()
ggraph(routes_tidy) + geom_edge_link() + geom_node_point() + theme_graph()
routes_igraph <- graph_from_data_frame(d = edges, vertices = nodes, directed = TRUE)
ggraph(routes_igraph, layout = "linear") +
geom_edge_arc(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label)) +
labs(edge_width = "Letters") +
theme_graph()
visNetwork(nodes, edges)
edges <- mutate(edges, width = weight/(max(weight)-min(weight))*10 )
visNetwork(nodes, edges) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
visEdges(arrows = "middle")
nodes_d3 <- mutate(nodes, id = id - 1)
edges_d3 <- mutate(edges, from = from - 1, to = to - 1)
forceNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Group = "id", Value = "width",
opacity = 1, fontSize = 16, zoom = TRUE)
sankeyNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Value = "weight", fontSize = 16, unit = "Letter(s)")
library(tidyverse)
sources <- muestra %>%
distinct(popular) %>%
rename(label = popular)
destinations <- muestra %>%
distinct(second_tag) %>%
rename(label = second_tag)
nodes <- full_join(sources, destinations, by = "label")
nodes
nodes <- nodes %>% rowid_to_column("id")
nodes
per_route <- muestra %>%
group_by(popular, second_tag) %>%
summarise(weight = sum(count)) %>%
ungroup()
per_route
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
edges <- select(edges, from, to, weight)
edges
routes_tidy <- tbl_graph(nodes = nodes, edges = edges, directed = TRUE)
routes_tidy
routes_tidy %>%
activate(edges) %>%
arrange(desc(weight))
ggraph(routes_tidy, layout = "graphopt") +
geom_node_point() +
geom_edge_link(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label), repel = TRUE) +
labs(edge_width = "Letters") +
theme_graph()
ggraph(routes_tidy) + geom_edge_link() + geom_node_point() + theme_graph()
routes_igraph <- graph_from_data_frame(d = edges, vertices = nodes, directed = TRUE)
ggraph(routes_igraph, layout = "linear") +
geom_edge_arc(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label)) +
labs(edge_width = "Letters") +
theme_graph()
visNetwork(nodes, edges)
edges <- mutate(edges, width = weight/(max(weight)-min(weight))*10 )
visNetwork(nodes, edges) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
visEdges(arrows = "middle")
nodes_d3 <- mutate(nodes, id = id - 1)
edges_d3 <- mutate(edges, from = from - 1, to = to - 1)
forceNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Group = "id", Value = "width",
opacity = 1, fontSize = 16, zoom = TRUE)
sankeyNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Value = "weight", fontSize = 16, unit = "Letter(s)")
library(network)
sources <- muestra %>%
distinct(popular) %>%
rename(label = popular)
destinations <- muestra %>%
distinct(second_tag) %>%
rename(label = second_tag)
nodes <- full_join(sources, destinations, by = "label")
nodes
nodes <- nodes %>% rowid_to_column("id")
nodes
per_route <- muestra %>%
group_by(popular, second_tag) %>%
summarise(weight = sum(count)) %>%
ungroup()
per_route
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
edges <- select(edges, from, to, weight)
edges
routes_tidy <- tbl_graph(nodes = nodes, edges = edges, directed = TRUE)
routes_tidy
routes_tidy %>%
activate(edges) %>%
arrange(desc(weight))
ggraph(routes_tidy, layout = "graphopt") +
geom_node_point() +
geom_edge_link(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label), repel = TRUE) +
labs(edge_width = "Letters") +
theme_graph()
ggraph(routes_tidy) + geom_edge_link() + geom_node_point() + theme_graph()
routes_igraph <- graph_from_data_frame(d = edges, vertices = nodes, directed = TRUE)
ggraph(routes_igraph, layout = "linear") +
geom_edge_arc(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label)) +
labs(edge_width = "Letters") +
theme_graph()
visNetwork(nodes, edges)
edges <- mutate(edges, width = weight/(max(weight)-min(weight))*10 )
visNetwork(nodes, edges) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
visEdges(arrows = "middle")
nodes_d3 <- mutate(nodes, id = id - 1)
edges_d3 <- mutate(edges, from = from - 1, to = to - 1)
forceNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Group = "id", Value = "width",
opacity = 1, fontSize = 16, zoom = TRUE)
sankeyNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Value = "weight", fontSize = 16, unit = "Letter(s)")
library(igraph)
sources <- muestra %>%
distinct(popular) %>%
rename(label = popular)
destinations <- muestra %>%
distinct(second_tag) %>%
rename(label = second_tag)
nodes <- full_join(sources, destinations, by = "label")
nodes
nodes <- nodes %>% rowid_to_column("id")
nodes
per_route <- muestra %>%
group_by(popular, second_tag) %>%
summarise(weight = sum(count)) %>%
ungroup()
per_route
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
edges <- select(edges, from, to, weight)
edges
routes_tidy <- tbl_graph(nodes = nodes, edges = edges, directed = TRUE)
routes_tidy
routes_tidy %>%
activate(edges) %>%
arrange(desc(weight))
ggraph(routes_tidy, layout = "graphopt") +
geom_node_point() +
geom_edge_link(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label), repel = TRUE) +
labs(edge_width = "Letters") +
theme_graph()
ggraph(routes_tidy) + geom_edge_link() + geom_node_point() + theme_graph()
routes_igraph <- graph_from_data_frame(d = edges, vertices = nodes, directed = TRUE)
ggraph(routes_igraph, layout = "linear") +
geom_edge_arc(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label)) +
labs(edge_width = "Letters") +
theme_graph()
visNetwork(nodes, edges)
edges <- mutate(edges, width = weight/(max(weight)-min(weight))*10 )
visNetwork(nodes, edges) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
visEdges(arrows = "middle")
nodes_d3 <- mutate(nodes, id = id - 1)
edges_d3 <- mutate(edges, from = from - 1, to = to - 1)
forceNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Group = "id", Value = "width",
opacity = 1, fontSize = 16, zoom = TRUE)
sankeyNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Value = "weight", fontSize = 16, unit = "Letter(s)")
library(networkD3)
sources <- muestra %>%
distinct(popular) %>%
rename(label = popular)
destinations <- muestra %>%
distinct(second_tag) %>%
rename(label = second_tag)
nodes <- full_join(sources, destinations, by = "label")
nodes
nodes <- nodes %>% rowid_to_column("id")
nodes
per_route <- muestra %>%
group_by(popular, second_tag) %>%
summarise(weight = sum(count)) %>%
ungroup()
per_route
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
edges <- select(edges, from, to, weight)
edges
routes_tidy <- tbl_graph(nodes = nodes, edges = edges, directed = TRUE)
routes_tidy
routes_tidy %>%
activate(edges) %>%
arrange(desc(weight))
ggraph(routes_tidy, layout = "graphopt") +
geom_node_point() +
geom_edge_link(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label), repel = TRUE) +
labs(edge_width = "Letters") +
theme_graph()
ggraph(routes_tidy) + geom_edge_link() + geom_node_point() + theme_graph()
routes_igraph <- graph_from_data_frame(d = edges, vertices = nodes, directed = TRUE)
ggraph(routes_igraph, layout = "linear") +
geom_edge_arc(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label)) +
labs(edge_width = "Letters") +
theme_graph()
visNetwork(nodes, edges)
edges <- mutate(edges, width = weight/(max(weight)-min(weight))*10 )
visNetwork(nodes, edges) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
visEdges(arrows = "middle")
nodes_d3 <- mutate(nodes, id = id - 1)
edges_d3 <- mutate(edges, from = from - 1, to = to - 1)
forceNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Group = "id", Value = "width",
opacity = 1, fontSize = 16, zoom = TRUE)
sankeyNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Value = "weight", fontSize = 16, unit = "Letter(s)")
forceNetwork(Links = edges_d3, Nodes = nodes_d3, Source = "from", Target = "to",
NodeID = "label", Group = "id", Value = "width",
opacity = 1, fontSize = 16, zoom = TRUE)
visNetwork(nodes, edges) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
visEdges(arrows = "middle")
visNetwork(nodes, edges)
library(visNetwork)
visNetwork(nodes, edges)
tabla_result %>% head()
routes_tidy %>%
activate(edges) %>%
arrange(desc(weight))
library(visNetwork)
sources <- muestra %>%
distinct(popular) %>%
rename(label = popular)
destinations <- muestra %>%
distinct(second_tag) %>%
rename(label = second_tag)
nodes <- full_join(sources, destinations, by = "label")
#nodes
nodes <- nodes %>% rowid_to_column("id")
#nodes
per_route <- muestra %>%
group_by(popular, second_tag) %>%
summarise(weight = sum(count)) %>%
ungroup()
per_route
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
edges <- select(edges, from, to, weight)
#edges
routes_tidy <- tbl_graph(nodes = nodes, edges = edges, directed = TRUE)
ggraph(routes_tidy, layout = "graphopt") +
geom_node_point() +
geom_edge_link(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label), repel = TRUE) +
labs(edge_width = "Letters") +
theme_graph()
visNetwork(nodes, edges)
sources <- muestra %>%
distinct(popular) %>%
rename(label = popular)
destinations <- muestra %>%
distinct(second_tag) %>%
rename(label = second_tag)
nodes <- full_join(sources, destinations, by = "label")
#nodes
nodes <- nodes %>% rowid_to_column("id")
per_route <- muestra %>%
group_by(popular, second_tag) %>%
summarise(weight = sum(count)) %>%
ungroup()
per_route
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
per_route %>% head
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
edges <- select(edges, from, to, weight)
routes_tidy <- tbl_graph(nodes = nodes, edges = edges, directed = TRUE)
library(tidygraph)
routes_tidy <- tbl_graph(nodes = nodes, edges = edges, directed = TRUE)
routes_tidy %>%
activate(edges) %>%
arrange(desc(weight))
ggraph(routes_tidy, layout = "graphopt") +
geom_node_point() +
geom_edge_link(aes(width = weight), alpha = 0.8) +
scale_edge_width(range = c(0.2, 2)) +
geom_node_text(aes(label = label), repel = TRUE) +
labs(edge_width = "Letters") +
theme_graph()
visNetwork(nodes, edges)
edges <- mutate(edges, width = weight/(max(weight)-min(weight))*10 )
visNetwork(nodes, edges) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
visEdges(arrows = "middle")
sources <- tabla_result %>%
distinct(popular) %>%
rename(label = popular)
destinations <- muestra %>%
distinct(second_tag) %>%
rename(label = second_tag)
nodes <- full_join(sources, destinations, by = "label")
nodes
nodes <- nodes %>% rowid_to_column("id")
nodes
per_route <- muestra %>%
group_by(popular, second_tag) %>%
summarise(weight = sum(count)) %>%
ungroup()
per_route
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
edges <- select(edges, from, to, weight)
edges
routes_tidy <- tbl_graph(nodes = nodes, edges = edges, directed = TRUE)
routes_tidy
routes_tidy %>%
activate(edges) %>%
arrange(desc(weight))
routes_igraph <- graph_from_data_frame(d = edges, vertices = nodes, directed = TRUE)
visNetwork(nodes, edges)
edges <- mutate(edges, width = weight/(max(weight)-min(weight))*10 )
visNetwork(nodes, edges) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
visEdges(arrows = "middle")
library(visNetwork)
library(tidygraph)
sources <- muestra %>%
distinct(popular) %>%
rename(label = popular)
destinations <- muestra %>%
distinct(second_tag) %>%
rename(label = second_tag)
nodes <- full_join(sources, destinations, by = "label")
#nodes
nodes <- nodes %>% rowid_to_column("id")
#nodes
per_route <- muestra %>%
group_by(popular, second_tag) %>%
summarise(weight = sum(count)) %>%
ungroup()
per_route
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
edges <- select(edges, from, to, weight)
#edges
edges <- mutate(edges, width = weight/(max(weight)-min(weight))*10 )
visNetwork(nodes, edges) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
visEdges(arrows = "middle")
library(visNetwork)
library(tidygraph)
sources <- tabla_result %>%
distinct(popular) %>%
rename(label = popular)
destinations <- muestra %>%
distinct(second_tag) %>%
rename(label = second_tag)
nodes <- full_join(sources, destinations, by = "label")
#nodes
nodes <- nodes %>% rowid_to_column("id")
#nodes
per_route <- muestra %>%
group_by(popular, second_tag) %>%
summarise(weight = sum(count)) %>%
ungroup()
per_route
edges <- per_route %>%
left_join(nodes, by = c("popular" = "label")) %>%
rename(from = id)
edges <- edges %>%
left_join(nodes, by = c("second_tag" = "label")) %>%
rename(to = id)
edges <- select(edges, from, to, weight)
#edges
edges <- mutate(edges, width = weight/(max(weight)-min(weight))*10 )
visNetwork(nodes, edges) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
visEdges(arrows = "middle")
info_extract <- function(url,names,node_name) {
#leemos la url
webpage <- read_html(url)
# ciclo for para cada nodo
for (i in 1:length(node_name)) {
#extraemos la infomacion del nodo
html <- html_nodes(webpage,node_name[i])
#lo convertimos en texto
name <- html_text(html)
if(i==1){
result <- name
}else {
result <- cbind(result,name)
}
}
#lo convertimos en un dataframe
result <- data.frame(result,stringsAsFactors = F)
names(result) <- names
result
}
extract <- info_extract(url,names,node_name)
head(extract)
